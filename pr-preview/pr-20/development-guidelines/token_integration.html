<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Token integration checklist - Building Secure Contracts</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="This repository, brought to you by Trail of Bits, outlines our guidelines and best practices to write secure smart contracts.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../static/custom.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <div class="sidebar-book-logo">
                    <img src="../static/TOB_Black.svg">
                </div>
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../development-guidelines/index.html">Development-guidelines</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../development-guidelines/guidelines.html">High-level best practices</a></li><li class="chapter-item expanded "><a href="../development-guidelines/token_integration.html" class="active">Token integration checklist</a></li><li class="chapter-item "><a href="../development-guidelines/incident_response.html">Incident Response Recommendations</a></li><li class="chapter-item "><a href="../development-guidelines/workflow.html">Secure development workflow</a></li></ol></li><li class="chapter-item expanded "><a href="../learn_evm/index.html">Learn EVM</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../learn_evm/evm_opcodes.html">EVM Opcode Reference</a></li><li class="chapter-item "><a href="../learn_evm/tracing.html">Transaction Tracing</a></li><li class="chapter-item "><a href="../learn_evm/yellow-paper.html">Yellow Paper Guidance</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../learn_evm/eips_forks.html">Forks &lt;&gt; EIPs</a></li><li class="chapter-item "><a href="../learn_evm/cips_forks.html">Forks &lt;&gt; CIPs</a></li><li class="chapter-item "><a href="../learn_evm/tips_upgrades.html">Upgrades &lt;&gt; TIPs</a></li><li class="chapter-item "><a href="../learn_evm/beps_forks.html">Forks &lt;&gt; BEPs</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../not-so-smart-contracts/index.html">Not so smart contracts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/index.html">Algorand</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/rekeying/index.html">Rekeying</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/unchecked_transaction_fee/index.html">Unchecked Transaction Fees</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/closing_account/index.html">Closing Account</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/closing_asset/index.html">Closing Asset</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/group_size_check/index.html">Group Size Check</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/time_based_replay_attack/index.html">Time-based Replay Attack</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/access_controls/index.html">Access Controls</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/asset_id_check/index.html">Asset Id Check</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/algorand/denial_of_service/index.html">Denial of Service</a></li></ol></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/index.html">Cairo</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/access_controls/index.html">Improper access controls</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/integer_division/index.html">Integer division errors</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/view_state/index.html">View state modifications</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/arithmetic_overflow/index.html">Arithmetic overflow</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/replay_protection/index.html">Signature replays</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/L1_to_L2_address_conversion/index.html">L1 to L2 Address Conversion</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/incorrect_felt_comparison/index.html">Incorrect Felt Comparison</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/namespace_storage_var_collision/index.html">Namespace Storage Var Collision</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cairo/dangerous_public_imports_in_libraries/index.html">Dangerous Public Imports in Libraries</a></li></ol></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/index.html">Cosmos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/incorrect_getsigners/index.html">Incorrect signers</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/non_determinism/index.html">Non-determinism</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/messages_priority/index.html">Not prioritized messages</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/abci_fast/index.html">Slow ABCI methods</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/abci_panic/index.html">ABCI methods panic</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/broken_bookkeeping/index.html">Broken bookkeeping</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/rounding_errors/index.html">Rounding errors</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/unregistered_msg_handler/index.html">Unregistered message handler</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/cosmos/missing_error_handler/index.html">Missing error handler</a></li></ol></li><li class="chapter-item "><a href="../not-so-smart-contracts/solana/index.html">Solana</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/solana/arbitrary_cpi/index.html">Arbitrary CPI</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/solana/improper_pda_validation/index.html">Improper PDA Validation</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/solana/ownership_check/index.html">Ownership Check</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/solana/signer_check/index.html">Signer Check</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/solana/sysvar_account_check/index.html">Sysvar Account Check</a></li></ol></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/index.html">Substrate</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/arithmetic_overflow/index.html">Arithmetic overflow</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/dont_panic/index.html">Don't panic!</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/weights_and_fees/index.html">Weights and fees</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/verify_first/index.html">Verify first</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/validate_unsigned/index.html">Unsigned transaction validation</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/randomness/index.html">Bad randomness</a></li><li class="chapter-item "><a href="../not-so-smart-contracts/substrate/origins/index.html">Bad origin</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../program-analysis/index.html">Program Analysis</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/index.html">Echidna</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/introduction/index.html">Introduction</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/introduction/fuzzing-introduction.html">Introduction to fuzzing</a></li><li class="chapter-item "><a href="../program-analysis/echidna/introduction/how-to-test-a-property.html">How to test a property</a></li></ol></li><li class="chapter-item "><a href="../program-analysis/echidna/basic/index.html">Basic</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/basic/testing-modes.html">How to select the most suitable testing mode</a></li><li class="chapter-item "><a href="../program-analysis/echidna/basic/common-testing-approaches.html">How to select the best testing approach</a></li><li class="chapter-item "><a href="../program-analysis/echidna/basic/filtering-functions.html">How to filter functions</a></li><li class="chapter-item "><a href="../program-analysis/echidna/basic/assertion-checking.html">How to test assertions</a></li><li class="chapter-item "><a href="../program-analysis/echidna/basic/property-creation.html">How to write good properties step by step</a></li></ol></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/index.html">Advanced</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/advanced/collecting-a-corpus.html">How to collect a corpus</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/optimization_mode.html">How to use optimization mode</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/finding-transactions-with-high-gas-consumption.html">How to detect high gas consumption</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/smart-contract-fuzzing-at-scale.html">How to perform smart contract fuzzing at a large scale</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/testing-bytecode.html">How to test bytecode-only contracts</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/hevm-cheats-to-test-permit.html">How to use hevm cheats to test permit</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/end-to-end-testing.html">How to seed Echidna with unit tests</a></li><li class="chapter-item "><a href="../program-analysis/echidna/advanced/using-multi-abi.html">Understanding and using multi-abi</a></li></ol></li><li class="chapter-item "><a href="../program-analysis/echidna/fuzzing_tips.html">Fuzzing tips</a></li><li class="chapter-item "><a href="../program-analysis/echidna/frequently_asked_questions.html">Frequently Asked Questions</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/index.html">Exercises</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-1.html">Exercise 1</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-2.html">Exercise 2</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-3.html">Exercise 3</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-4.html">Exercise 4</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-5.html">Exercise 5</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-6.html">Exercise 6</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-7.html">Exercise 7</a></li><li class="chapter-item "><a href="../program-analysis/echidna/exercises/Exercise-8.html">Exercise 8</a></li></ol></li></ol></li><li class="chapter-item "><a href="../program-analysis/manticore/index.html">Manticore</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/manticore/symbolic-execution-introduction.html">Introduction to symbolic execution</a></li><li class="chapter-item "><a href="../program-analysis/manticore/running-under-manticore.html">Running under Manticore</a></li><li class="chapter-item "><a href="../program-analysis/manticore/getting-throwing-paths.html">Getting throwing paths</a></li><li class="chapter-item "><a href="../program-analysis/manticore/adding-constraints.html">Adding constraints</a></li><li class="chapter-item "><a href="../program-analysis/manticore/exercises/index.html">Exercises</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/manticore/exercises/example.html">Example</a></li><li class="chapter-item "><a href="../program-analysis/manticore/exercises/exercise1.html">Exercise 1</a></li><li class="chapter-item "><a href="../program-analysis/manticore/exercises/exercise2.html">Exercise 2</a></li></ol></li></ol></li><li class="chapter-item "><a href="../program-analysis/slither/index.html">Slither</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../program-analysis/slither/static_analysis.html">Static Analysis</a></li><li class="chapter-item "><a href="../program-analysis/slither/api.html">API</a></li><li class="chapter-item "><a href="../program-analysis/slither/exercise1.html">Exercise 1</a></li><li class="chapter-item "><a href="../program-analysis/slither/exercise2.html">Exercise 2</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../resources/tob_blogposts.html">Resources</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Building Secure Contracts</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/crytic/building-secure-contracts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/crytic/building-secure-contracts/edit/master/./development-guidelines/token_integration.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="token-integration-checklist"><a class="header" href="#token-integration-checklist">Token integration checklist</a></h1>
<p>The following checklist provides recommendations for interactions with arbitrary tokens. Every unchecked item should be justified, and its associated risks, understood.</p>
<p>For convenience, all Slither <a href="https://github.com/crytic/slither#tools">utilities</a> can be run directly on a token address, such as the following:</p>
<pre><code class="language-bash">slither-check-erc 0xdac17f958d2ee523a2206206994597c13d831ec7 TetherToken --erc erc20
slither-check-erc 0x06012c8cf97BEaD5deAe237070F9587f8E7A266d KittyCore --erc erc721
</code></pre>
<p>To follow this checklist, use the below output from Slither for the token:</p>
<pre><code class="language-bash">- slither-check-erc [target] [contractName] [optional: --erc ERC_NUMBER]
- slither [target] --print human-summary
- slither [target] --print contract-summary
- slither-prop . --contract ContractName # requires configuration, and use of Echidna and Manticore
</code></pre>
<h2 id="general-considerations"><a class="header" href="#general-considerations">General considerations</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The contract has a security review.</strong> Avoid interacting with contracts that lack a security review. Check the length of the assessment (i.e., the level of effort), the reputation of the security firm, and the number and severity of the findings.</li>
<li><input disabled="" type="checkbox"/>
<strong>You have contacted the developers.</strong> You may need to alert their team to an incident. Look for appropriate contacts on <a href="https://github.com/crytic/blockchain-security-contacts">blockchain-security-contacts</a>.</li>
<li><input disabled="" type="checkbox"/>
<strong>They have a security mailing list for critical announcements.</strong> Their team should advise users (like you!) when critical issues are found or when upgrades occur.</li>
</ul>
<h2 id="contract-composition"><a class="header" href="#contract-composition">Contract composition</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The contract avoids unneeded complexity.</strong> The token should be a simple contract; a token with complex code requires a higher standard of review. Use Slither’s <a href="https://github.com/crytic/slither/wiki/Printer-documentation#human-summary"><code>human-summary</code> printer</a> to identify complex code.</li>
<li><input disabled="" type="checkbox"/>
<strong>The contract uses <code>SafeMath</code>.</strong> Contracts that do not use <code>SafeMath</code> require a higher standard of review. Inspect the contract by hand for <code>SafeMath</code> usage.</li>
<li><input disabled="" type="checkbox"/>
<strong>The contract has only a few non–token-related functions.</strong> Non-token-related functions increase the likelihood of an issue in the contract. Use Slither’s <a href="https://github.com/crytic/slither/wiki/Printer-documentation#contract-summary"><code>contract-summary</code> printer</a> to broadly review the code used in the contract.</li>
<li><input disabled="" type="checkbox"/>
<strong>The token only has one address.</strong> Tokens with multiple entry points for balance updates can break internal bookkeeping based on the address (e.g., <code>balances[token_address][msg.sender]</code> may not reflect the actual balance).</li>
</ul>
<h2 id="owner-privileges"><a class="header" href="#owner-privileges">Owner privileges</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The token is not upgradeable.</strong> Upgradeable contracts may change their rules over time. Use Slither’s <a href="https://github.com/crytic/slither/wiki/Printer-documentation#contract-summary"><code>human-summary</code> printer</a> to determine whether the contract is upgradeable.</li>
<li><input disabled="" type="checkbox"/>
<strong>The owner has limited minting capabilities.</strong> Malicious or compromised owners can abuse minting capabilities. Use Slither’s <a href="https://github.com/crytic/slither/wiki/Printer-documentation#contract-summary"><code>human-summary</code> printer</a> to review minting capabilities, and consider manually reviewing the code.</li>
<li><input disabled="" type="checkbox"/>
<strong>The token is not pausable.</strong> Malicious or compromised owners can trap contracts relying on pausable tokens. Identify pausable code by hand.</li>
<li><input disabled="" type="checkbox"/>
<strong>The owner cannot blacklist the contract.</strong> Malicious or compromised owners can trap contracts relying on tokens with a blacklist. Identify blacklisting features by hand.</li>
<li><input disabled="" type="checkbox"/>
<strong>The team behind the token is known and can be held responsible for abuse.</strong> Contracts with anonymous development teams or teams that reside in legal shelters require a higher standard of review.</li>
</ul>
<h2 id="erc20-tokens"><a class="header" href="#erc20-tokens">ERC20 tokens</a></h2>
<h3 id="erc20-conformity-checks"><a class="header" href="#erc20-conformity-checks">ERC20 conformity checks</a></h3>
<p>Slither includes a utility, <a href="https://github.com/crytic/slither/wiki/ERC-Conformance"><code>slither-check-erc</code></a>, that reviews the conformance of a token to many related ERC standards. Use <code>slither-check-erc</code> to review the following:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong><code>Transfer</code> and <code>transferFrom</code> return a boolean.</strong> Several tokens do not return a boolean on these functions. As a result, their calls in the contract might fail.</li>
<li><input disabled="" type="checkbox"/>
<strong>The <code>name</code>, <code>decimals</code>, and <code>symbol</code> functions are present if used.</strong> These functions are optional in the ERC20 standard and may not be present.</li>
<li><input disabled="" type="checkbox"/>
<strong><code>Decimals</code> returns a <code>uint8</code>.</strong> Several tokens incorrectly return a <code>uint256</code>. In such cases, ensure that the value returned is below 255.</li>
<li><input disabled="" type="checkbox"/>
<strong>The token mitigates the known <a href="https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729">ERC20 race condition</a>.</strong> The ERC20 standard has a known ERC20 race condition that must be mitigated to prevent attackers from stealing tokens.</li>
</ul>
<p>Slither includes a utility, <a href="https://github.com/crytic/slither/wiki/Property-generation"><code>slither-prop</code></a>, that generates unit tests and security properties that can discover many common ERC flaws. Use slither-prop to review the following:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The contract passes all unit tests and security properties from <code>slither-prop</code>.</strong> Run the generated unit tests and then check the properties with <a href="https://github.com/crytic/echidna">Echidna</a> and <a href="https://manticore.readthedocs.io/en/latest/verifier.html">Manticore</a>.</li>
</ul>
<h3 id="risks-of-erc20-extensions"><a class="header" href="#risks-of-erc20-extensions">Risks of ERC20 Extensions</a></h3>
<p>The behavior of certain contracts may differ from the original ERC specification. Conduct a manual review of the following conditions:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The token is not an ERC777 token and has no external function call in <code>transfer</code> or <code>transferFrom</code>.</strong> External calls in the transfer functions can lead to reentrancies.</li>
<li><input disabled="" type="checkbox"/>
<strong><code>Transfer</code> and <code>transferFrom</code> should not take a fee.</strong> Deflationary tokens can lead to unexpected behavior.</li>
<li><input disabled="" type="checkbox"/>
<strong>Potential interest earned from the token is taken into account.</strong> Some tokens distribute interest to token holders. This interest may be trapped in the contract if not taken into account.</li>
</ul>
<h3 id="token-scarcity"><a class="header" href="#token-scarcity">Token scarcity</a></h3>
<p>Reviews of token scarcity issues must be executed manually. Check for the following conditions:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The supply is owned by more than a few users.</strong> If a few users own most of the tokens, they can influence operations based on the tokens’ repartition.</li>
<li><input disabled="" type="checkbox"/>
<strong>The total supply is sufficient.</strong> Tokens with a low total supply can be easily manipulated.</li>
<li><input disabled="" type="checkbox"/>
<strong>The tokens are located in more than a few exchanges.</strong> If all the tokens are in one exchange, a compromise of the exchange could compromise the contract relying on the token.</li>
<li><input disabled="" type="checkbox"/>
<strong>Users understand the risks associated with a large amount of funds or flash loans.</strong> Contracts relying on the token balance must account for attackers with a large amount of funds or attacks executed through flash loans.</li>
<li><input disabled="" type="checkbox"/>
<strong>The token does not allow flash minting.</strong> Flash minting can lead to substantial swings in the balance and the total supply, which necessitate strict and comprehensive overflow checks in the operation of the token.</li>
</ul>
<h2 id="erc721-tokens"><a class="header" href="#erc721-tokens">ERC721 tokens</a></h2>
<h3 id="erc721-conformity-checks"><a class="header" href="#erc721-conformity-checks">ERC721 Conformity Checks</a></h3>
<p>The behavior of certain contracts may differ from the original ERC specification. Conduct a manual review of the following conditions:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>Transfers of tokens to the 0x0 address revert.</strong> Several tokens allow transfers to 0x0 and consider tokens transferred to that address to have been burned; however, the ERC721 standard requires that such transfers revert.</li>
<li><input disabled="" type="checkbox"/>
<strong><code>safeTransferFrom</code> functions are implemented with the correct signature.</strong> Several token contracts do not implement these functions. A transfer of NFTs to one of those contracts can result in a loss of assets.</li>
<li><input disabled="" type="checkbox"/>
<strong>The <code>name</code>, <code>decimals</code>, and <code>symbol</code> functions are present if used.</strong> These functions are optional in the ERC721 standard and may not be present.</li>
<li><input disabled="" type="checkbox"/>
<strong>If it is used, <code>decimals</code> returns a <code>uint8(0)</code>.</strong> Other values are invalid.</li>
<li><input disabled="" type="checkbox"/>
<strong>The <code>name</code> and <code>symbol</code> functions can return an empty string.</strong> This behavior is allowed by the standard.</li>
<li><input disabled="" type="checkbox"/>
<strong>The <code>ownerOf</code> function reverts if the <code>tokenId</code> is invalid or is set to a token that has already been burned.</strong> The function cannot return 0x0. This behavior is required by the standard, but it is not always properly implemented.</li>
<li><input disabled="" type="checkbox"/>
<strong>A transfer of an NFT clears its approvals.</strong> This is required by the standard.</li>
<li><input disabled="" type="checkbox"/>
<strong>The token ID of an NFT cannot be changed during its lifetime.</strong> This is required by the standard.</li>
</ul>
<h3 id="common-risks-of-the-erc721-standard"><a class="header" href="#common-risks-of-the-erc721-standard">Common Risks of the ERC721 Standard</a></h3>
<p>To mitigate the risks associated with ERC721 contracts, conduct a manual review of the following conditions:</p>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>The <code>onERC721Received</code> callback is taken into account.</strong> External calls in the transfer functions can lead to reentrancies, especially when the callback is not explicit (e.g., in <a href="https://www.paradigm.xyz/2021/08/the-dangers-of-surprising-code/"><code>safeMint</code></a> calls).</li>
<li><input disabled="" type="checkbox"/>
<strong>When an NFT is minted, it is safely transferred to a smart contract.</strong> If there is a minting function, it should behave similarly to safeTransferFrom and properly handle the minting of new tokens to a smart contract. This will prevent a loss of assets.</li>
<li><input disabled="" type="checkbox"/>
<strong>The burning of a token clears its approvals.</strong> If there is a burning function, it should clear the token’s previous approvals.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../development-guidelines/guidelines.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../development-guidelines/incident_response.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../development-guidelines/guidelines.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../development-guidelines/incident_response.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
